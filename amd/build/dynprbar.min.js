define("local_dynprogressbar/dynprbar",["exports","./repository"],(function(_exports,_repository){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=_exports.changeProgressbar=_exports.changeProgressPercentage=_exports.addProgressFromCoreData=void 0;_exports.addProgressFromCoreData=async()=>{const prbar=document.getElementsByClassName("progress-bar progress-bar-info")[0],spanElement=document.querySelector("strong.progress-bar-num"),user_id=prbar.getAttribute("userid"),course_id=prbar.getAttribute("courseid"),response=await(0,_repository.getActivityCompletion)(user_id,course_id);if(window.console.log("getActivityCompletion----response",response),response&&response.statuses&&Array.isArray(response.statuses)){let count=0,countall=0;response.statuses.forEach((status=>{status.state>0&&count++,countall++}));var newwidth=Math.round(count/countall*100);prbar.style.width=newwidth+"%",spanElement.innerHTML=newwidth+"%"}};_exports.changeProgressPercentage=async()=>{const prbar=document.getElementsByClassName("progress-bar progress-bar-info")[0],spanElement=document.querySelector("strong.progress-bar-num"),course_id=prbar.getAttribute("courseid"),response=await(0,_repository.getProgressPercentage)(course_id);if(response&&response.progress){response.warnings.length>0&&console.log("Warnings:",response.warnings),window.console.log("getProgressPercentage----response",response);var newwidth=response.progress;prbar.style.width=newwidth+"%",spanElement.innerHTML=newwidth+"%"}else console.log("no completion detected")};const changeProgressbar=async()=>{const course_id=document.getElementsByClassName("progress-bar progress-bar-info")[0].getAttribute("courseid"),response=await(0,_repository.getProgressbarInnerHTML)(course_id);if(response&&response.innerHTML){window.console.log("getProgressbarInnerHTML----response",response);var innerHTML=response.innerHTML;const elementToReplace=document.getElementsByClassName("progress courseview")[0],newElement=document.createElement("div");newElement.innerHTML=innerHTML;elementToReplace.parentNode.replaceChild(newElement,elementToReplace)}else console.log("no completion detected");return!0};_exports.changeProgressbar=changeProgressbar;var dynprbar_action=changeProgressbar;_exports.init=()=>{window.addEventListener("load",(function(){var prbar=document.getElementsByClassName("progress-bar progress-bar-info")[0];console.log("prbarneusrc"+prbar),document.addEventListener("cmcompleted",(function(event){console.log("cmcompleted----Custom event triggered:",event.detail.message),setTimeout(dynprbar_action,300)}))}))}}));

//# sourceMappingURL=dynprbar.min.js.map